{"version":3,"sources":["../../src/pages/tabs/tabs.module.ts","../../src/pages/tabs/tabs.ts"],"names":[],"mappings":"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","file":"12.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { TabsPage } from './tabs';\n\n@NgModule({\n  declarations: [\n    TabsPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(TabsPage),\n    TranslateModule.forChild()\n  ],\n  exports: [\n    TabsPage\n  ]\n})\nexport class TabsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/tabs/tabs.module.ts","import {Component, OnInit, HostListener} from '@angular/core';\nimport {NavParams, IonicPage, ModalController, NavController, Events} from 'ionic-angular';\n\nimport {Iframe} from \"../iframe/iframe\";\nimport { LoginService } from '../../providers/logins/login.service';\nimport { LanguageService } from \"../../providers/language/language.service\";\nimport { User } from '../../models/user.model';\n\nclass ModalOptions {\n\tpublic cssClass?: string;\n\tpublic title?: string;\n}\n\n@IonicPage()\n@Component({\n  templateUrl: 'tabs.html'\n})\nexport class TabsPage implements OnInit {\n  tabs: Array<any> = [];\n  bodyTag: any;\n  user: User;\n  mySelectedIndex: number;\n  login_modal: any;\n  login_modal_open = false;\n  force_login_active = false;\n\n  constructor(\n    private modalCtrl: ModalController,\n    private navParams: NavParams,\n    private events: Events,\n    private loginservice: LoginService,\n    private languageservice: LanguageService,\n    public nav: NavController\n  ) {}\n\n  ngOnInit() {\n\n    // Login status\n    this.bodyTag = document.getElementsByTagName('body')[0];\n    this.loginservice.loginStatus().subscribe(user => {\n      this.user = user\n      if(user) {\n        this.bodyTag.classList.add('loggedin')\n      } else {\n        this.bodyTag.classList.remove('loggedin')\n      }\n    });\n\n\n    this.mySelectedIndex = this.navParams.data.tabIndex || 0;\n    this.force_login_active = (this.navParams.data[0] && this.navParams.data[0].force_login_active);\n\n    // root=null if opening in the IAB\n    for(let tab of this.navParams.data) {\n      let target = this.maybeOpenIAB(tab);\n      if(target) {\n        tab.root = null;\n        tab.target = target;\n      }\n      if(typeof(tab.extra_classes) !== 'undefined' && (tab.extra_classes.indexOf('loginmodal') >= 0||tab.extra_classes.indexOf('logoutmodal') >= 0)) {\n        tab.root = null;\n      }\n      // If current tab is going to be used as a global tab opened from side menu and you do not want to show it on the tab bar\n      if (tab.extra_classes === 'hidden-tab') {\n        tab.show = false;\n      }\n      this.tabs.push(tab);\n    }\n\n  }\n\n  onIonSelect($event, tab) {\n\n    // yield login\n    /**\n     * TODO: test again in a newer version of Ionic\n     * \n     * This feature isn't working because the ionSelect doesn't\n     * allow you to $event.stopPropagation() or $event.preventDefault()\n     * \n     * We need to test the yield login BEFORE transitioning to the selcted tab\n     */\n    // if(this.yieldLogin($event, tab))\n    //   return false;\n    \n\n    if(tab.url && tab.target) {\n      \n      let url = tab.url;\n      \n      if(tab.target == '_system') {\n        let use_language = (typeof(tab.extra_classes) !== 'undefined' && (tab.extra_classes.indexOf('use-language') >= 0));\n        url = this.languageservice.removeAppParams(url, use_language);\n      }\n\n      this.openIab(url, tab.target);\n    }\n    if(typeof(tab.extra_classes) !== 'undefined' && (tab.extra_classes.indexOf('loginmodal') >= 0||tab.extra_classes.indexOf('logoutmodal') >= 0)) {\n      this.loginModal({title:tab.title});\n    }\n  }\n\n  loginModal(opt?: ModalOptions) {\n\n\t\tconst css = (opt && opt.cssClass) ? opt.cssClass : '';\n\t\tconst params = (opt && opt.title) ? {title: opt.title} : {};\n\t\n\t\tthis.login_modal = this.modalCtrl.create('LoginModal', params, {\n\t\t\tcssClass: css\n\t\t});\n\n\t\tthis.login_modal.onDidDismiss(data => {\n\t\t\tthis.login_modal_open = false;\n\t\t});\n\n\t\tif( this.login_modal_open === false) {\n\t\t\tthis.login_modal_open = true;\n\t\t\tthis.login_modal.present();\n\t\t}\n\t}\n\n  maybeOpenIAB(tab) {\n\n    if (\n      tab.extra_classes &&\n      (tab.extra_classes.indexOf('system') >= 0 || tab.extra_classes.indexOf('external') >= 0) &&\n      tab.url &&\n      tab.url.indexOf('http') === 0\n    ) {\n      return this.getIabTarget(tab.extra_classes);\n    }\n\n    return false;\n  }\n\n  getIabTarget(extra_classes) {\n    if(extra_classes.indexOf('system') >= 0) {\n      return '_system';\n    } else if(extra_classes.indexOf('external') >= 0) {\n      return '_blank';\n    }\n    return false;\n  }\n\n  openIab( link, target, options = null ) {\n    \n    window.open(link, target, options );\n\n  }\n\n  /**\n   * Open the login modal if the menu item's extra_classes contains 'yieldlogin'\n   * @param tab \n   */\n  yieldLogin($event, tab) {\n\n    if(tab && tab.extra_classes && tab.extra_classes.indexOf('yieldlogin') >= 0) {\n      if(this.user) { // logged in\n        return false;\n      } else { // logged out, show login modal\n        this.events.publish('login:force_login');\n\n        // This portion needs to work before using this function\n        // $event.preventDefault();\n        // $event.stopPropagation();\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  // ng2 way of adding a listener\n  @HostListener('window:message', ['$event'])\n\n  onMessage(event) {\n    this.myListeners(event)\n  }\n\n  myListeners(e) {\n\n    // if it's not our json object, return\n    if (e.data.indexOf('{') != 0)\n      return;\n\n    var data = JSON.parse(e.data);\n\n    // close all windows and then re-open root page, for LearnDash\n    if( data.apppage && data.apppage.root ) {\n\n      let page = { title: ( data.title ? data.title : '' ), component: Iframe, url: data.apppage.url, classes: null, page_type: null, type: null };\n      // for learndash, when we have a redirect\n      this.nav.popToRoot({animate: false}).then( ()=> {\n        this.nav.push( Iframe, page );\n      })\n\n    }\n\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/tabs/tabs.ts"],"sourceRoot":""}