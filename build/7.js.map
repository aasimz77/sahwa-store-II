{"version":3,"sources":["../../src/pages/bp-profile/bp-profile.module.ts","../../src/pipes/sanitize-html/sanitize-html.module.ts","../../src/pipes/sanitize-html/sanitize-html.ts","../../src/pages/bp-profile/bp-profile.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAyC;AACO;AACM;AACT;AACuC;AAepF;IAAA;IAAkC,CAAC;IAAtB,mBAAmB;QAb/B,+DAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,kEAAa;aACd;YACD,OAAO,EAAE;gBACP,sEAAe,CAAC,QAAQ,CAAC,kEAAa,CAAC;gBACvC,4EAAe,CAAC,QAAQ,EAAE;gBAC1B,qGAAkB;aACnB;YACD,OAAO,EAAE;gBACP,kEAAa;aACd;SACF,CAAC;OACW,mBAAmB,CAAG;IAAD,0BAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;ACnBS;AACM;AAM/C;IAAA;IAAkC,CAAC;IAAtB,kBAAkB;QAJ9B,+DAAQ,CAAC;YACR,YAAY,EAAE,CAAC,oEAAY,CAAC;YAC5B,OAAO,EAAE,CAAC,oEAAY,CAAC;SACxB,CAAC;OACW,kBAAkB,CAAI;IAAD,yBAAC;CAAA;AAAJ;;;;;;;;;;;;;;;;;;;;;ACPqB;AACa;AAKjE;IAEG,sBAAmB,UAAwB;QAAxB,eAAU,GAAV,UAAU,CAAc;IAAE,CAAC;IAE9C,gCAAS,GAAT,UAAU,CAAS;QAChB,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,uBAAuB,CAAC,CAAC,CAAC,CAAC;IACrD,CAAC;IANS,YAAY;QAHxB,2DAAI,CAAC;YACF,IAAI,EAAE,cAAc;SACvB,CAAC;yCAGgC,+EAAY;OAFjC,YAAY,CAOxB;IAAD,mBAAC;CAAA;AAPwB;;;;;;;;;;;;;;;;;;;;;;;;ACNuH;AAChG;AACK;AACa;AAC3B;AAOvC;IAaE,uBACS,GAAkB,EAClB,SAAoB,EACpB,QAAwB,EACxB,QAAkB,EAClB,MAAc,EACd,UAAsB,EACtB,SAA0B,EAC1B,WAA8B,EAC9B,SAA0B,EAC1B,OAAgB,EAChB,SAA2B;QAXpC,iBAqBC;QApBQ,QAAG,GAAH,GAAG,CAAe;QAClB,cAAS,GAAT,SAAS,CAAW;QACpB,aAAQ,GAAR,QAAQ,CAAgB;QACxB,aAAQ,GAAR,QAAQ,CAAU;QAClB,WAAM,GAAN,MAAM,CAAQ;QACd,eAAU,GAAV,UAAU,CAAY;QACtB,cAAS,GAAT,SAAS,CAAiB;QAC1B,gBAAW,GAAX,WAAW,CAAmB;QAC9B,cAAS,GAAT,SAAS,CAAiB;QAC1B,YAAO,GAAP,OAAO,CAAS;QAChB,cAAS,GAAT,SAAS,CAAkB;QApBpC,YAAO,GAAY,KAAK,CAAC;QAIzB,YAAO,GAAY,KAAK,CAAC;QAEzB,gBAAW,GAAY,KAAK,CAAC;QAiB3B,mCAAmC;QACnC,MAAM,CAAC,SAAS,CAAC,YAAY,EAAE,cAAI;YACjC,KAAI,CAAC,UAAU,GAAG,IAAI;YACtB,KAAI,CAAC,OAAO,GAAG,KAAI,CAAC,UAAU,CAAC,OAAO;YACtC,KAAI,CAAC,SAAS,CAAE,IAAI,CAAE;QACxB,CAAC,CAAC,CAAC;IAEL,CAAC;IAED,gCAAQ,GAAR;QAEE,EAAE,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK,IAAI,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAG,CAAC,CAAC,CAAC;YACrD,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,KAAK,CAAC;YACnC,IAAI,CAAC,OAAO,GAAG,IAAI;QACvB,CAAC;QAED,EAAE,EAAE,IAAI,CAAC,SAAU,CAAC,CAAC,CAAC;YACpB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;YAE7C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;QACrD,CAAC;QAED,EAAE,EAAE,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,UAAW,CAAC,CAAC,CAAC;YACvC,IAAI,CAAC,UAAU,EAAE;QACnB,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,IAAI,CAAC,SAAS,CAAE,IAAI,CAAE;QACxB,CAAC;IAEH,CAAC;IAED,wCAAgB,GAAhB;QAEE,6BAA6B;QAC7B,EAAE,EAAE,IAAI,CAAC,QAAS,CAAC,CAAC,CAAC;YACnB,IAAI,CAAC,SAAS,CAAE,KAAK,CAAE;QACzB,CAAC;QAED,IAAI,CAAC,gBAAgB,EAAE;IAEzB,CAAC;IAED,mCAAW,GAAX;QAEE,oCAAoC;QACpC,EAAE,EAAC,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;YACvB,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;QAGjB,EAAE,EAAE,IAAI,CAAC,QAAS,CAAC,CAAC,CAAC;YACnB,IAAI,CAAC,SAAS,CAAE,KAAK,CAAE;QACzB,CAAC;QACD,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC1B,CAAC;IAED,kCAAU,GAAV;QAAA,iBAcC;QAZC,0GAA0G;QAC1G,IAAI,CAAC,OAAO,CAAC,GAAG,CAAE,YAAY,CAAE,CAAC,IAAI,CAAE,oBAAU;YAE/C,EAAE,EAAE,UAAU,IAAI,UAAU,CAAC,OAAQ,CAAC,CAAC,CAAC;gBACtC,KAAI,CAAC,UAAU,GAAG,UAAU;gBAC5B,KAAI,CAAC,OAAO,GAAG,KAAI,CAAC,UAAU,CAAC,OAAO;gBACtC,KAAI,CAAC,SAAS,CAAE,IAAI,CAAE;YACxB,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,KAAI,CAAC,OAAO,GAAG,IAAI;YACrB,CAAC;QAEH,CAAC,CAAC;IACJ,CAAC;IAED,iCAAS,GAAT,UAAW,OAAO;QAAlB,iBAqBC;QAnBC,IAAI,CAAC,OAAO,GAAG,KAAK;QAEpB,EAAE,EAAE,OAAQ,CAAC;YACX,IAAI,CAAC,WAAW,EAAE;QAEpB,EAAE,EAAE,IAAI,CAAC,OAAO,KAAK,IAAI,CAAC,UAAU,CAAC,OAAQ,CAAC,CAAC,CAAC;YAC9C,IAAI,CAAC,WAAW,GAAG,IAAI;QACzB,CAAC;QAED,IAAI,CAAC,UAAU,CAAC,OAAO,CAAE,UAAU,GAAG,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAE,CAAC,IAAI,CAAE,cAAI;YAE9E,KAAI,CAAC,QAAQ,GAAG,IAAI;YACpB,KAAI,CAAC,WAAW,EAAE;QACpB,CAAC,CAAC,CAAC,KAAK,CAAE,WAAC;YACT,KAAI,CAAC,OAAO,GAAG,IAAI;YACnB,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;YACf,KAAI,CAAC,WAAW,EAAE;QACpB,CAAC,CAAC;IAEJ,CAAC;IAED,oCAAY,GAAZ,UAAc,QAAQ;QAEpB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,EAAE;YACtB,UAAU,EAAE,UAAU;YACtB,aAAa,EAAE,QAAQ,CAAC,EAAE;SAC3B,CAAC;IAEJ,CAAC;IAED,gCAAgC;IAChC,iCAAS,GAAT,UAAW,GAAG;QAEZ,EAAE,EAAE,CAAC,GAAI,CAAC;YACR,MAAM,CAAC;QAET,EAAE,EAAE,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAE,CAAC,CAAC,CAAC;YAC9B,MAAM,CAAC,GAAG,CAAC;QACb,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,MAAM,CAAC,QAAQ,GAAG,GAAG,CAAC;QACxB,CAAC;IAEH,CAAC;IAED,oCAAY,GAAZ;QAEE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAE,YAAY,CAAE;IAE/B,CAAC;IAED,yCAAiB,GAAjB;QACE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAE,iBAAiB,CAAE;IACpC,CAAC;IAED,gCAAQ,GAAR,UAAU,QAAQ,EAAE,QAAQ;QAA5B,iBAyBC;QAvBC,IAAI,CAAC,WAAW,EAAE;QAElB,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAE,QAAQ,EAAE,IAAI,CAAC,UAAU,EAAE,QAAQ,CAAE,CAAC,IAAI,CAAE,kBAAQ;YAE5E,KAAI,CAAC,YAAY,CAAE,QAAQ,CAAE;YAE7B,KAAI,CAAC,WAAW,EAAE;QACpB,CAAC,CAAC,CAAC,KAAK,CAAE,WAAC;YAET,KAAI,CAAC,SAAS,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC,SAAS,CAAE,cAAI;gBAExD,IAAI,GAAG,GAAG,IAAI,CAAC;gBAEf,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;gBACf,EAAE,EAAC,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,MAAM,IAAI,GAAG,CAAC,CAAC,CAAC;oBAC/B,GAAG,GAAG,wCAAwC,CAAC;gBACjD,CAAC;gBACD,KAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;gBACvB,KAAI,CAAC,WAAW,EAAE;YACpB,CAAC,CAAC,CAAC;QAEL,CAAC,CAAC;IAEJ,CAAC;IAED,+BAAO,GAAP,UAAS,QAAQ;QAEf,IAAI,CAAC,GAAG,CAAC,IAAI,CAAE,YAAY,EAAE;YAC3B,YAAY,EAAE,IAAI;YAClB,SAAS,EAAE,IAAI;YACf,UAAU,EAAE,IAAI,CAAC,UAAU;YAC3B,UAAU,EAAE,QAAQ,CAAC,EAAE;SACxB,CAAC,CAAC;IAEL,CAAC;IAED,wCAAgB,GAAhB;QAAA,iBAgBC;QAdC,EAAE,EAAE,CAAC,IAAI,CAAC,UAAW,CAAC;YACpB,MAAM,CAAC;QAET,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAE,IAAI,CAAC,UAAU,CAAE,CAAC,IAAI,CAAC,eAAK;YAE5D,iCAAiC;YACjC,KAAI,CAAC,iBAAiB,GAAS,KAAM,CAAC,MAAM,CAAC;QAE/C,CAAC,CAAC,CAAC,KAAK,CAAC,UAAC,GAAG;YAEX,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC;QAEnB,CAAC,CAAC,CAAC;IAEL,CAAC;IAED,+BAAO,GAAP,UAAQ,IAAI;QACV,MAAM,CAAC,IAAI,CAAE,IAAI,EAAE,QAAQ,CAAE,CAAC;IAChC,CAAC;IAED;;OAEG;IACI,4CAAoB,GAA3B;QAAA,iBAOC;QANC,IAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,kBAAkB,CAAC,CAAC;QACnE,wDAAwD;QACxD,gBAAgB,CAAC,YAAY,CAAC;YAC5B,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACvB,CAAC,CAAC,CAAC;QACH,gBAAgB,CAAC,OAAO,EAAE,CAAC;IAC7B,CAAC;IAED,sCAAc,GAAd;QAEE,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,YAAY,CAAE,CAAC;QACxD,UAAU,CAAC,OAAO,EAAE,CAAC;IAEvB,CAAC;IAED,oCAAY,GAAZ,UAAa,GAAG;QAAhB,iBAcC;QAZC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,SAAS,CAAE,qBAAW;YAE5C,IAAI,KAAK,GAAG,KAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBAChC,OAAO,EAAE,GAAG;gBACZ,QAAQ,EAAE,IAAI;gBACd,QAAQ,EAAE,QAAQ;aACnB,CAAC,CAAC;YAEH,KAAK,CAAC,OAAO,EAAE,CAAC;QAElB,CAAC,CAAC;IAEJ,CAAC;IAED,mCAAW,GAAX;QACE,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;QAEzC,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;IACzB,CAAC;IAED,mCAAW,GAAX;QAEE,EAAE,EAAE,IAAI,CAAC,OAAQ,CAAC,CAAC,CAAC;YAClB,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;QACzB,CAAC;IAEH,CAAC;IAED,6DAA6D;IAC7D,yCAAiB,GAAjB;QACE,IAAI,GAAG,GAAG,EAAE;QAEZ,EAAE,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAE,CAAC;YAC3B,GAAG,GAAG,EAAC,SAAS,EAAE,SAAS,EAAC;QAE9B,IAAI,CAAC,GAAG,CAAC,GAAG,CAAE,GAAG,CAAE;IACrB,CAAC;IA9QU,aAAa;QAJzB,gEAAS,CAAC;YACT,WAAW,EAAE,SAAiB;WACR;SACvB,CAAC;6EAe2B;YACP,qEAAS;YACV,gEAAc;YACd,8DAAQ;YACV,qFAAM;YACF,sEAAU;YACX,wEAAe;YACb,uEAAiB;YACnB,gEAAe;YACjB,6EAAO;YACL,UAAgB;OAxBzB,aAAa,CAgRzB;IAAD,CAAC;AAAA;SAhRY,aAAa,gB","file":"7.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { BpProfilePage } from './bp-profile';\nimport { SanitizeHtmlModule } from '../../pipes/sanitize-html/sanitize-html.module';\n\n@NgModule({\n  declarations: [\n    BpProfilePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(BpProfilePage),\n    TranslateModule.forChild(),\n    SanitizeHtmlModule\n  ],\n  exports: [\n    BpProfilePage\n  ]\n})\nexport class BpProfilePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/bp-profile/bp-profile.module.ts","import { NgModule } from '@angular/core';\nimport { SanitizeHtml } from './sanitize-html';\n\n@NgModule({\n  declarations: [SanitizeHtml],\n  exports: [SanitizeHtml]\n})\nexport class SanitizeHtmlModule { }\n\n\n// WEBPACK FOOTER //\n// ./src/pipes/sanitize-html/sanitize-html.module.ts","import { Pipe, PipeTransform } from '@angular/core';\nimport {DomSanitizer, SafeHtml} from '@angular/platform-browser';\n\n@Pipe({\n    name: 'sanitizeHtml'\n})\nexport class SanitizeHtml implements PipeTransform  {\n\n   constructor(public _sanitizer: DomSanitizer){}  \n\n   transform(v: string) : SafeHtml {\n      return this._sanitizer.bypassSecurityTrustHtml(v); \n   } \n} \n\n\n// WEBPACK FOOTER //\n// ./src/pipes/sanitize-html/sanitize-html.ts","import {NavController, NavParams, LoadingController, Platform, ViewController, IonicPage, Events, ToastController, ModalController} from 'ionic-angular';\nimport {Component, OnInit} from '@angular/core';\nimport {TranslateService} from '@ngx-translate/core';\nimport {BpProvider} from '../../providers/buddypress/bp-provider';\nimport {Storage} from '@ionic/storage';\n\n@IonicPage()\n@Component({\n  templateUrl: 'bp-profile.html',\n  selector: 'bp-profile'\n})\nexport class BpProfilePage implements OnInit {\n\n  content: any;\n  listenFunc: Function;\n  rtlBack: boolean = false;\n  user_id: any;\n  userData: any;\n  login_data: any;\n  isError: boolean = false;\n  spinner: any;\n  isMyProfile: boolean = false;\n  notificationCount: any;\n\n  constructor(\n    public nav: NavController, \n    public navParams: NavParams, \n    public viewCtrl: ViewController,\n    public platform: Platform,\n    public events: Events,\n    public bpProvider: BpProvider,\n    public toastCtrl: ToastController,\n    public loadingCtrl: LoadingController,\n    public modalCtrl: ModalController,\n    public storage: Storage,\n    public translate: TranslateService\n    ) {\n\n    // set login data after modal login\n    events.subscribe('user:login', data => {\n      this.login_data = data\n      this.user_id = this.login_data.user_id\n      this.setupUser( true )\n    });\n\n  }\n\n  ngOnInit() {\n\n    if( this.platform.isRTL && this.viewCtrl.enableBack() ) {\n        this.viewCtrl.showBackButton(false)\n        this.rtlBack = true\n    }\n\n    if( this.navParams ) {\n      this.user_id = this.navParams.get('user_id');\n\n      this.login_data = this.navParams.get('login_data');\n    }\n\n    if( !this.user_id && !this.login_data ) {\n      this.checkLogin()\n    } else {\n      this.setupUser( true )\n    }    \n\n  }\n\n  ionViewWillEnter() {\n\n    // update profile when cached\n    if( this.userData ) {\n      this.setupUser( false )\n    }\n\n    this.getNotifications()\n\n  }\n\n  ionSelected() {\n\n    // close stacked pages if their open\n    if(this.nav.length() > 1)\n      this.nav.pop();\n\n\n    if( this.userData ) {\n      this.setupUser( false )\n    }\n    this.getNotifications();\n  }\n\n  checkLogin() {\n\n    // if we are here it's probably because this page was loaded from the menu, not from the members list page\n    this.storage.get( 'user_login' ).then( login_data => {\n\n      if( login_data && login_data.user_id ) {\n        this.login_data = login_data\n        this.user_id = this.login_data.user_id\n        this.setupUser( true )\n      } else {\n        this.isError = true\n      }\n\n    })\n  }\n\n  setupUser( spinner ) {\n\n    this.isError = false\n\n    if( spinner )\n      this.showSpinner()\n\n    if( this.user_id === this.login_data.user_id ) {\n      this.isMyProfile = true\n    }\n\n    this.bpProvider.getItem( 'members/' + this.user_id, this.login_data ).then( data => {\n\n      this.userData = data\n      this.hideSpinner()\n    }).catch( e => {\n      this.isError = true\n      console.warn(e)\n      this.hideSpinner()\n    })\n\n  }\n\n  userActivity( userData ) {\n\n    this.nav.push('BpList', {\n      list_route: 'activity',\n      user_activity: userData.id\n    })\n\n  }\n\n  // maybe add https to avatar url\n  formatUrl( url ) {\n\n    if( !url )\n      return;\n\n    if( url.indexOf('http') >= 0 ) {\n      return url;\n    } else {\n      return 'https:' + url;\n    }\n\n  }\n\n  showMessages() {\n\n    this.nav.push( 'BpMessages' )\n\n  }\n\n  notificationsPage() {\n    this.nav.push( 'BpNotifications' )\n  }\n\n  doFriend( friendId, unfriend ) {\n\n    this.showSpinner()\n\n    this.bpProvider.doFriend( friendId, this.login_data, unfriend ).then( response => {\n      \n      this.presentToast( response )\n\n      this.hideSpinner()\n    }).catch( e => {\n\n      this.translate.get('There was a problem.').subscribe( text => {\n        \n        let msg = text;\n  \n        console.warn(e)\n        if(e.status && e.status == 404) {\n          msg = 'Friendship connections are not enabled';\n        }\n        this.presentToast(msg);\n        this.hideSpinner()\n      });\n\n    })\n\n  }\n\n  message( userData ) {\n\n    this.nav.push( 'BpMessages', {\n      singleThread: true,\n      newThread: true,\n      login_data: this.login_data,\n      recipients: userData.id\n    });\n\n  }\n\n  getNotifications() {\n\n    if( !this.login_data )\n      return;\n\n    this.bpProvider.getNotifications( this.login_data ).then(items => {\n\n      // Loads posts from WordPress API\n      this.notificationCount = (<any>items).length;\n\n    }).catch((err) => {\n\n      console.warn(err)\n\n    });\n\n  }\n\n  iabLink(link) {\n    window.open( link, '_blank' );\n  }\n\n  /**\n   * Opens the edit profile modal and updates the user data on dismiss\n   */\n  public openEditProfileModal(): void {\n    const editProfileModal = this.modalCtrl.create('EditProfileModal');\n    // Update user data after closing the edit profile modal\n    editProfileModal.onDidDismiss(() => {\n      this.setupUser(true);\n    });\n    editProfileModal.present();\n  }\n\n  openLoginModal() {\n\n    const loginModal = this.modalCtrl.create('LoginModal' );\n    loginModal.present();\n\n  }\n\n  presentToast(msg) {\n\n    this.translate.get(msg).subscribe( translation => {\n\n      let toast = this.toastCtrl.create({\n        message: msg,\n        duration: 3000,\n        position: 'bottom'\n      });\n\n      toast.present();\n\n    })\n\n  }\n\n  showSpinner() {\n    this.spinner = this.loadingCtrl.create();\n\n    this.spinner.present();\n  }\n\n  hideSpinner() {\n\n    if( this.spinner ) {\n      this.spinner.dismiss();\n    }\n\n  }\n\n  // changes the back button transition direction if app is RTL\n  backRtlTransition() {\n    let obj = {}\n\n    if( this.platform.is('ios') )\n      obj = {direction: 'forward'}\n    \n    this.nav.pop( obj )\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/bp-profile/bp-profile.ts"],"sourceRoot":""}